//
// auto-generated by ops.py
//

#define OPS_GPU

int xdim0_opensbliblock00Kernel028;
int xdim1_opensbliblock00Kernel028;
int xdim2_opensbliblock00Kernel028;
int xdim3_opensbliblock00Kernel028;
int xdim4_opensbliblock00Kernel028;
int xdim5_opensbliblock00Kernel028;
int xdim6_opensbliblock00Kernel028;
int xdim7_opensbliblock00Kernel028;
int xdim8_opensbliblock00Kernel028;

//user function
inline 
 void opensbliblock00Kernel028(const ptr_double rhoE_B0,
  const ptr_double p_B0,
  const ptr_double rho_B0,
  const ptr_double rhou0_B0,
  const ptr_double u0_B0,
  const ptr_double a_B0,
  ptr_double wk0_B0,
  ptr_double wk2_B0,
  ptr_double wk1_B0)
{

   double AVG_0_a = 0.0;
   double AVG_0_u0 = 0.0;
   double inv_AVG_a = 0.0;



   double AVG_0_0_LEV_10 = 0.0;
   double AVG_0_0_LEV_01 = 0.0;
   double AVG_0_0_LEV_21 = 0.0;
   double AVG_0_0_LEV_12 = 0.0;
   double AVG_0_0_LEV_22 = 0.0;
   double AVG_0_0_LEV_02 = 0.0;
   double AVG_0_0_LEV_00 = 0.0;
   double AVG_0_0_LEV_11 = 0.0;
   double AVG_0_0_LEV_20 = 0.0;

   double kappa = 1.5;
   double AVG_0_0_REV_00 = 0.0;
   double AVG_0_0_REV_01 = 0.0;
   double AVG_0_0_REV_02 = 0.0;
   double AVG_0_0_REV_10 = 0.0;
   double AVG_0_0_REV_11 = 0.0;
   double AVG_0_0_REV_12 = 0.0;
   double AVG_0_0_REV_20 = 0.0;
   double AVG_0_0_REV_21 = 0.0;
   double AVG_0_0_REV_22 = 0.0;

   double ws_0 = 0.0;
   double ws_1 = 0.0;
   double ws_2 = 0.0;

   double du_0 = 0.0;
   double du_1 = 0.0;
   double du_2 = 0.0;

   double alpha_00 = 0.0;
   double alpha_10 = 0.0;
   double alpha_20 = 0.0;
   double alpha_01 = 0.0;
   double alpha_11 = 0.0;
   double alpha_21 = 0.0;
   double alpha_02 = 0.0;
   double alpha_12 = 0.0;
   double alpha_22 = 0.0;

   double lambda = 0.0;
   double sigma_0 = 0.0;
   double sigma_1 = 0.0;
   double sigma_2 = 0.0;

   double S = 0.0;
   double g_00 = 0.0;
   double g_10 = 0.0;
   double g_20 = 0.0;
   double g_01 = 0.0;
   double g_11 = 0.0;
   double g_21 = 0.0;

   double gamma_0 = 0.0;
   double gamma_1 = 0.0;
   double gamma_2 = 0.0;

   double phi_0 = 0.0;
   double phi_1 = 0.0;
   double phi_2 = 0.0;

   double theta_hat_00 = 0.0;
   double theta_hat_10 = 0.0;
   double theta_hat_20 = 0.0;
   double theta_hat_01 = 0.0;
   double theta_hat_11 = 0.0;
   double theta_hat_21 = 0.0;
   double theta_0 = 0.0;
   double theta_1 = 0.0;
   double theta_2 = 0.0;

   double phi_star_0 = 0.0;
   double phi_star_1 = 0.0;
   double phi_star_2 = 0.0;

   double eps = 0.00000001;
   double delta = 0.5;


   AVG_0_a = (rc1)*(OPS_ACC(a_B0, -1) + OPS_ACC(a_B0, 0));

   AVG_0_u0 = (rc1)*(OPS_ACC(u0_B0, -1) + OPS_ACC(u0_B0, 0));

   inv_AVG_a = 1.0/AVG_0_a;


   AVG_0_0_LEV_00 = (rc4)*AVG_0_u0*inv_AVG_a*(gama*AVG_0_a*AVG_0_u0*pow(inv_AVG_a, 2) - AVG_0_a*AVG_0_u0*pow(inv_AVG_a,
      2) + 2);

   AVG_0_0_LEV_01 = -rc1*inv_AVG_a*(gama*AVG_0_a*AVG_0_u0*pow(inv_AVG_a, 2) - AVG_0_a*AVG_0_u0*pow(inv_AVG_a, 2) + 1);

   AVG_0_0_LEV_02 = (rc1)*gamma_m1*pow(inv_AVG_a, 2);

   AVG_0_0_LEV_10 = -rc1*(gama*pow(AVG_0_u0, 2)*pow(inv_AVG_a, 2) - pow(AVG_0_u0, 2)*pow(inv_AVG_a, 2) - 2);

   AVG_0_0_LEV_11 = gamma_m1*AVG_0_u0*pow(inv_AVG_a, 2);

   AVG_0_0_LEV_12 = -gamma_m1*pow(inv_AVG_a, 2);

   AVG_0_0_LEV_20 = (rc4)*AVG_0_u0*inv_AVG_a*(gama*AVG_0_a*AVG_0_u0*pow(inv_AVG_a, 2) - AVG_0_a*AVG_0_u0*pow(inv_AVG_a,
      2) - 2);

   AVG_0_0_LEV_21 = -rc1*inv_AVG_a*(gama*AVG_0_a*AVG_0_u0*pow(inv_AVG_a, 2) - AVG_0_a*AVG_0_u0*pow(inv_AVG_a, 2) - 1);

   AVG_0_0_LEV_22 = (rc1)*gamma_m1*pow(inv_AVG_a, 2);


   du_0 = OPS_ACC(rho_B0, 0) - OPS_ACC(rho_B0, -1);
   du_1 = OPS_ACC(rhou0_B0, 0) - OPS_ACC(rhou0_B0, -1);
   du_2 = OPS_ACC(rhoE_B0, 0) - OPS_ACC(rhoE_B0, -1);


   alpha_00 = AVG_0_0_LEV_00*du_0 + AVG_0_0_LEV_01*du_1 + AVG_0_0_LEV_02*du_2;
   alpha_10 = AVG_0_0_LEV_10*du_0 + AVG_0_0_LEV_11*du_1 + AVG_0_0_LEV_12*du_2;
   alpha_20 = AVG_0_0_LEV_20*du_0 + AVG_0_0_LEV_21*du_1 + AVG_0_0_LEV_22*du_2;



   AVG_0_a = (rc1)*(OPS_ACC(a_B0, 0) + OPS_ACC(a_B0, 1));

   AVG_0_u0 = (rc1)*(OPS_ACC(u0_B0, 0) + OPS_ACC(u0_B0, 1));

   inv_AVG_a = 1.0/AVG_0_a;


   AVG_0_0_LEV_00 = (rc4)*AVG_0_u0*inv_AVG_a*(gama*AVG_0_a*AVG_0_u0*pow(inv_AVG_a, 2) - AVG_0_a*AVG_0_u0*pow(inv_AVG_a,
      2) + 2);

   AVG_0_0_LEV_01 = -rc1*inv_AVG_a*(gama*AVG_0_a*AVG_0_u0*pow(inv_AVG_a, 2) - AVG_0_a*AVG_0_u0*pow(inv_AVG_a, 2) + 1);

   AVG_0_0_LEV_02 = (rc1)*gamma_m1*pow(inv_AVG_a, 2);

   AVG_0_0_LEV_10 = -rc1*(gama*pow(AVG_0_u0, 2)*pow(inv_AVG_a, 2) - pow(AVG_0_u0, 2)*pow(inv_AVG_a, 2) - 2);

   AVG_0_0_LEV_11 = gamma_m1*AVG_0_u0*pow(inv_AVG_a, 2);

   AVG_0_0_LEV_12 = -gamma_m1*pow(inv_AVG_a, 2);

   AVG_0_0_LEV_20 = (rc4)*AVG_0_u0*inv_AVG_a*(gama*AVG_0_a*AVG_0_u0*pow(inv_AVG_a, 2) - AVG_0_a*AVG_0_u0*pow(inv_AVG_a,
      2) - 2);

   AVG_0_0_LEV_21 = -rc1*inv_AVG_a*(gama*AVG_0_a*AVG_0_u0*pow(inv_AVG_a, 2) - AVG_0_a*AVG_0_u0*pow(inv_AVG_a, 2) - 1);

   AVG_0_0_LEV_22 = (rc1)*gamma_m1*pow(inv_AVG_a, 2);

   du_0 = OPS_ACC(rho_B0, 1) - OPS_ACC(rho_B0, 0);
   du_1 = OPS_ACC(rhou0_B0, 1) - OPS_ACC(rhou0_B0, 0);
   du_2 = OPS_ACC(rhoE_B0, 1) - OPS_ACC(rhoE_B0, 0);

   alpha_01 = AVG_0_0_LEV_00*du_0 + AVG_0_0_LEV_01*du_1 + AVG_0_0_LEV_02*du_2;
   alpha_11 = AVG_0_0_LEV_10*du_0 + AVG_0_0_LEV_11*du_1 + AVG_0_0_LEV_12*du_2;
   alpha_21 = AVG_0_0_LEV_20*du_0 + AVG_0_0_LEV_21*du_1 + AVG_0_0_LEV_22*du_2;


   AVG_0_0_REV_00 = 1;
   AVG_0_0_REV_01 = 1;
   AVG_0_0_REV_02 = 1;
   AVG_0_0_REV_10 = AVG_0_u0-inv_AVG_a;
   AVG_0_0_REV_11 = AVG_0_u0;
   AVG_0_0_REV_12 = AVG_0_u0+inv_AVG_a;
   AVG_0_0_REV_20 = pow(AVG_0_a,2) / gamma_m1 + 0.5*pow(AVG_0_u0,2) - AVG_0_u0*AVG_0_a;
   AVG_0_0_REV_21 = 0.5*pow(AVG_0_u0,2);
   AVG_0_0_REV_22 = pow(AVG_0_a,2)*(1/gamma_m1+ AVG_0_u0*inv_AVG_a);


   ws_0 = AVG_0_u0 - AVG_0_a;
   ws_1 = AVG_0_u0;
   ws_2 = AVG_0_u0 + AVG_0_a;



   AVG_0_a = (rc1)*(OPS_ACC(a_B0, 1) + OPS_ACC(a_B0, 2));

   AVG_0_u0 = (rc1)*(OPS_ACC(u0_B0, 1) + OPS_ACC(u0_B0, 2));

   inv_AVG_a = 1.0/AVG_0_a;


   AVG_0_0_LEV_00 = (rc4)*AVG_0_u0*inv_AVG_a*(gama*AVG_0_a*AVG_0_u0*pow(inv_AVG_a, 2) - AVG_0_a*AVG_0_u0*pow(inv_AVG_a,
      2) + 2);

   AVG_0_0_LEV_01 = -rc1*inv_AVG_a*(gama*AVG_0_a*AVG_0_u0*pow(inv_AVG_a, 2) - AVG_0_a*AVG_0_u0*pow(inv_AVG_a, 2) + 1);

   AVG_0_0_LEV_02 = (rc1)*gamma_m1*pow(inv_AVG_a, 2);

   AVG_0_0_LEV_10 = -rc1*(gama*pow(AVG_0_u0, 2)*pow(inv_AVG_a, 2) - pow(AVG_0_u0, 2)*pow(inv_AVG_a, 2) - 2);

   AVG_0_0_LEV_11 = gamma_m1*AVG_0_u0*pow(inv_AVG_a, 2);

   AVG_0_0_LEV_12 = -gamma_m1*pow(inv_AVG_a, 2);

   AVG_0_0_LEV_20 = (rc4)*AVG_0_u0*inv_AVG_a*(gama*AVG_0_a*AVG_0_u0*pow(inv_AVG_a, 2) - AVG_0_a*AVG_0_u0*pow(inv_AVG_a,
      2) - 2);

   AVG_0_0_LEV_21 = -rc1*inv_AVG_a*(gama*AVG_0_a*AVG_0_u0*pow(inv_AVG_a, 2) - AVG_0_a*AVG_0_u0*pow(inv_AVG_a, 2) - 1);

   AVG_0_0_LEV_22 = (rc1)*gamma_m1*pow(inv_AVG_a, 2);

   du_0 = OPS_ACC(rho_B0, 2) - OPS_ACC(rho_B0, 1);
   du_1 = OPS_ACC(rhou0_B0, 2) - OPS_ACC(rhou0_B0, 1);
   du_2 = OPS_ACC(rhoE_B0, 2) - OPS_ACC(rhoE_B0, 1);

   alpha_02 = AVG_0_0_LEV_00*du_0 + AVG_0_0_LEV_01*du_1 + AVG_0_0_LEV_02*du_2;
   alpha_12 = AVG_0_0_LEV_10*du_0 + AVG_0_0_LEV_11*du_1 + AVG_0_0_LEV_12*du_2;
   alpha_22 = AVG_0_0_LEV_20*du_0 + AVG_0_0_LEV_21*du_1 + AVG_0_0_LEV_22*du_2;




   lambda = dt / Delta0block0;









   sigma_0 = fabs(alpha_01) >= delta ? fabs(alpha_01) : (pow(alpha_01,2) + pow(delta,2)) / (2*delta);
   sigma_1 = fabs(alpha_11) >= delta ? fabs(alpha_11) : (pow(alpha_11,2) + pow(delta,2)) / (2*delta);
   sigma_2 = fabs(alpha_21) >= delta ? fabs(alpha_21) : (pow(alpha_21,2) + pow(delta,2)) / (2*delta);




   S = alpha_01 < 0 ? -1 : (alpha_01 > 0 ? 1 : 0);
   g_00 = S*fmax(fmax(0,fmin(2*fabs(alpha_01), S*alpha_00)),fmin(fabs(alpha_01),2*S*alpha_00));

   S = alpha_11 < 0 ? -1 : (alpha_11 > 0 ? 1 : 0);
   g_10 = S*fmax(fmax(0,fmin(2*fabs(alpha_11), S*alpha_10)),fmin(fabs(alpha_11),2*S*alpha_10));

   S = alpha_21 < 0 ? -1 : (alpha_21 > 0 ? 1 : 0);
   g_20 = S*fmax(fmax(0,fmin(2*fabs(alpha_21), S*alpha_20)),fmin(fabs(alpha_21),2*S*alpha_20));

   S = alpha_02 < 0 ? -1 : (alpha_02 > 0 ? 1 : 0);
   g_01 = S*fmax(fmax(0,fmin(2*fabs(alpha_02), S*alpha_01)),fmin(fabs(alpha_02),2*S*alpha_01));

   S = alpha_12 < 0 ? -1 : (alpha_12 > 0 ? 1 : 0);
   g_11 = S*fmax(fmax(0,fmin(2*fabs(alpha_12), S*alpha_11)),fmin(fabs(alpha_12),2*S*alpha_11));

   S = alpha_22 < 0 ? -1 : (alpha_22 > 0 ? 1 : 0);
   g_21 = S*fmax(fmax(0,fmin(2*fabs(alpha_22), S*alpha_21)),fmin(fabs(alpha_22),2*S*alpha_21));



   gamma_0 = (alpha_00 == 0) ? 0 : sigma_0*alpha_01*(g_01 - g_00) / (pow(alpha_01,2)+eps);
   gamma_1 = (alpha_01 == 0) ? 0 : sigma_1*alpha_11*(g_11 - g_10) / (pow(alpha_11,2)+eps);
   gamma_2 = (alpha_02 == 0) ? 0 : sigma_2*alpha_21*(g_21 - g_20) / (pow(alpha_21,2)+eps);





   phi_0 = -sigma_0*(g_01 + g_00) + (fabs(ws_0 + gamma_0) - lambda*pow(ws_0,2))*alpha_01;
   phi_1 = -sigma_1*(g_11 + g_10) + (fabs(ws_1 + gamma_1) - lambda*pow(ws_1,2))*alpha_11;
   phi_2 = -sigma_2*(g_21 + g_20) + (fabs(ws_2 + gamma_2) - lambda*pow(ws_2,2))*alpha_21;





   theta_hat_00 = pow(fabs((fabs(alpha_01) - fabs(alpha_00)) / (fabs(alpha_01) + fabs(alpha_00)+eps)),2);
   theta_hat_10 = pow(fabs((fabs(alpha_11) - fabs(alpha_10)) / (fabs(alpha_11) + fabs(alpha_10)+eps)),2);
   theta_hat_20 = pow(fabs((fabs(alpha_21) - fabs(alpha_20)) / (fabs(alpha_21) + fabs(alpha_20)+eps)),2);


   theta_hat_01 = pow(fabs((fabs(alpha_02) - fabs(alpha_01)) / (fabs(alpha_02) + fabs(alpha_01)+eps)),2);
   theta_hat_11 = pow(fabs((fabs(alpha_12) - fabs(alpha_11)) / (fabs(alpha_12) + fabs(alpha_11)+eps)),2);
   theta_hat_21 = pow(fabs((fabs(alpha_22) - fabs(alpha_21)) / (fabs(alpha_22) + fabs(alpha_21)+eps)),2);


   theta_0 =fmax(theta_hat_00, theta_hat_01);
   theta_1 =fmax(theta_hat_10, theta_hat_11);
   theta_2 =fmax(theta_hat_20, theta_hat_21);



   phi_star_0 = kappa*theta_0*phi_0;
   phi_star_1 = kappa*theta_1*phi_1;
   phi_star_2 = kappa*theta_2*phi_2;



   OPS_ACC(wk0_B0, 0) = 0.5*(AVG_0_0_REV_00*phi_star_0 + AVG_0_0_REV_01*phi_star_1 + AVG_0_0_REV_02*phi_star_2);
   OPS_ACC(wk1_B0, 0) = 0.5*(AVG_0_0_REV_10*phi_star_0 + AVG_0_0_REV_11*phi_star_1 + AVG_0_0_REV_12*phi_star_2);
   OPS_ACC(wk2_B0, 0) = 0.5*(AVG_0_0_REV_20*phi_star_0 + AVG_0_0_REV_21*phi_star_1 + AVG_0_0_REV_22*phi_star_2);


}


void opensbliblock00Kernel028_c_wrapper(
  double *p_a0,
  double *p_a1,
  double *p_a2,
  double *p_a3,
  double *p_a4,
  double *p_a5,
  double *p_a6,
  double *p_a7,
  double *p_a8,
  int x_size) {
  #ifdef OPS_GPU
  #pragma acc parallel deviceptr(p_a0,p_a1,p_a2,p_a3,p_a4,p_a5,p_a6,p_a7,p_a8)
  #pragma acc loop
  #endif
  for ( int n_x=0; n_x<x_size; n_x++ ){
    const ptr_double ptr0 = {  p_a0 + n_x*1*1 };
    const ptr_double ptr1 = {  p_a1 + n_x*1*1 };
    const ptr_double ptr2 = {  p_a2 + n_x*1*1 };
    const ptr_double ptr3 = {  p_a3 + n_x*1*1 };
    const ptr_double ptr4 = {  p_a4 + n_x*1*1 };
    const ptr_double ptr5 = {  p_a5 + n_x*1*1 };
    ptr_double ptr6 = {  p_a6 + n_x*1*1 };
    ptr_double ptr7 = {  p_a7 + n_x*1*1 };
    ptr_double ptr8 = {  p_a8 + n_x*1*1 };
    opensbliblock00Kernel028( ptr0,
          ptr1,ptr2,
          ptr3,ptr4,
          ptr5,ptr6,
          ptr7,ptr8 );

  }
}
